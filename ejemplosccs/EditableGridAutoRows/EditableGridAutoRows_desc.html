<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Editable Grid with Auto New Rows</title>
<link rel="stylesheet" type="text/css" href="../cchelpstyle.css">
</head>
<body>
<p>{Header}</p>
<h1>Editable Grid with new rows added automatically</h1>
<h2>Description</h2>
<p>This example shows how to create an&nbsp;Editable Grid in which new empty rows 
  are automatically added as you progressively enter information now new records. 
  Usually, an editable grid has a set number of empty rows for adding new records.&nbsp;This 
  example shows how the empty rows can be dynamically&nbsp;displayed as the user 
  fills in information. JavaScript code is used to detect whenever new information 
  is added to a field so that a new row can be displayed automatically.</p>

<h2>Usage</h2>
<ol>
  <li>Enter information for a new record in the bottom empty row of the editable 
    grid.
  <li>After entering a department name, click on the Tab key to move to the next 
    field. At this point, a new empty row is added.
  <li>Select the department manager for the record you are currently adding then 
    you can proceed to add another record in the empty row that was dynamically 
    added.  <li>After adding all the records you wish to add, click on the 'Submit' button 
    to save the information.</li>
</ol>
<p></p>

<h2>Steps to recreate</h2>
<ol>
  <li>Use the <strong>Editable Grid</strong> Builder to create the editable grid based on 
    the "departments" table and its two columns: <em>department_name</em> and <em>department_manager_id</em>. 
  <li>Set the <strong>Empty Rows</strong> property of the editable grid to 30.&nbsp;This 
    number defines the maximum number of empty rows which could possibly&nbsp;appear 
    for adding new records.
  <li>Convert the <em>manager_id</em> TextBox to a ListBox. For the ListBox set 
    the <strong>Connection</strong> property to&nbsp;<em>IntranetDB</em>&nbsp; and select&nbsp;<em>employees 
    </em> in the <strong>Data Source</strong> property. Select <em>emp_id </em>in the <strong>Bound 
    Column</strong> property, <em>emp_name</em> in the <strong>Text Column</strong> Property 
    and <em>Integer </em>in the <strong>Data Type</strong> property. 
  <li>Switch to HTML mode and locate the table row &lt;TR&gt; where the TextBox 
    and ListBox appear. Within the &lt;TR&gt; tag, add the attributes <em>id=""</em>, 
    <em>name=""</em> and <em>AddedRow=""</em>. 
  <li>Place the cursor within the value of the <em>id</em> attribute and add a 
    Label control called <em>RowIDAttribute</em>. Do the same for the <em>name</em> 
    attribute by adding a Label control called <em>RowNameAttribute</em>, 
    then add third Label control into the <em>AddedRow</em> attribute and this time call it <em>AddedRow</em>.
    After the three attributes add a <em>RowStyleAttribute</em> Label at the end of the &lt;TR&gt; tag.
  <li>Locate the &lt;input&gt; tag for the department_name TextBox field and add 
    the attributes<em> onchange="ShowNewEmptyRow(this);"</em> and <em>id="&#123;AddedRow&#125;"</em>. 
  <li>Set the <strong>Content</strong> property of the <em>RowStyleAttribute</em> Label 
    to <em>HTML</em>. 
  <li>While in HTML mode, add the code for the <em>ShowNewEmptyRow() </em>JavaScript 
    function as shown in the example.
  <li>Add the appropriate programming code into the <strong>Before Show Row</strong> and 
    <strong>Before Execute Delete</strong> events of the editable Grid as shown in the 
    example.
   <br>Note: In .NET the <strong>Before Show</strong> and <strong>Before Submit</strong> event are used additionally.

  <li>Make cosmetic changes as needed, by modifying the text and captions within 
    the HTML.</li>
</ol>

<h2>Database Tables used</h2>
<p>Database: <em>Intranet</em></p>
<p>Tables: <em>departments, employees</em></p>

<h2>Programming Notes</h2>
<p>The editable grid's <strong><em>Before Show Row</em></strong> event is used to fill the 
  <em>id</em>, <em>name </em>and <em>style </em>attributes of the &lt;TR&gt; tag 
  depending on whether the row is empty or filled.</p>
<p>
<strong>For .NET </strong>
<br>
The editable grid's <strong><em>Before Show event</em></strong> is used to create the element array. <br>
The editable grid's <strong><em>Before Show Row</em></strong> event is used to fill the style attributes of the &lt;TR&gt; tag.<br>
The editable grid's <strong><em>Before Submit</em></strong> event is used for the error handling when redisplaying the page, as the second raising of BeforeShowRow event is not supported.</p>


<p>The editable grid's <strong><em>Before Execute Delete</em></strong> event is used to update 
  the related employees table to set the value of the 'department_id' field to 
  NULL if a department is deleted.</p>
</body>
</html>