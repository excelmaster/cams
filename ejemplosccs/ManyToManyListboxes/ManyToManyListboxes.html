<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>Updating Many-to-Many Relations via Two Listboxes</title>
<script language="JavaScript" type="text/javascript">
//Begin CCS script
//Include JSFunctions @1-6FA9DE6A
</script>
<script language="JavaScript" src="../ClientI18N.asp?file=Functions.js&amp;lang={res:CCS_LocaleID}" type="text/javascript" charset="utf-8"></script>
<script language="JavaScript" type="text/javascript">
//End Include JSFunctions

//page_employees_record_RightButton_OnClick @38-E7C40504
function page_employees_record_RightButton_OnClick()
{
    var result;
//End page_employees_record_RightButton_OnClick

//Custom Code @43-2A29BDB7

 var AvailableLB = document.getElementById("available");
 var LinkedLB = document.getElementById("linked");
 for (var i=0; i < AvailableLB.length; i++) {
   if (AvailableLB.options[i].selected == true) {
       LinkedLB.options[LinkedLB.length] = 
       new Option(AvailableLB.options[i].text, AvailableLB.options[i].value);
       AvailableLB.options[i] = null;
       i=i-1;
   }
 }
//End Custom Code

//Close page_employees_record_RightButton_OnClick @38-BC33A33A
    return result;
}
//End Close page_employees_record_RightButton_OnClick

//page_employees_record_LeftButton_OnClick @39-FDD2413E
function page_employees_record_LeftButton_OnClick()
{
    var result;
//End page_employees_record_LeftButton_OnClick

//Custom Code @42-2A29BDB7
     
 var AvailableLB = document.getElementById("available");
 var LinkedLB = document.getElementById("linked");
 for (var i=0; i < LinkedLB.length; i++) {
   if (LinkedLB.options[i].selected == true) {
      AvailableLB.options[AvailableLB.length] = 
          new Option(LinkedLB.options[i].text, LinkedLB.options[i].value);
      LinkedLB.options[i] = null;
      i=i-1;
   }
 }

//End Custom Code

//Close page_employees_record_LeftButton_OnClick @39-BC33A33A
    return result;
}
//End Close page_employees_record_LeftButton_OnClick

//page_employees_record_OnSubmit @14-80AF1965
function page_employees_record_OnSubmit()
{
    var result;
//End page_employees_record_OnSubmit

//Custom Code @47-2A29BDB7

 var LinkedLB = document.getElementById("linked");
 document.employees_record.LinkedID.value = ""
 for (i=0; i<LinkedLB.options.length; i++) {
    if (document.employees_record.LinkedID.value != "" ) {
        document.employees_record.LinkedID.value = document.employees_record.LinkedID.value + ","
        }
        document.employees_record.LinkedID.value = document.employees_record.LinkedID.value + LinkedLB.options[i].value
 }
 result = true;
//End Custom Code

//Close page_employees_record_OnSubmit @14-BC33A33A
    return result;
}
//End Close page_employees_record_OnSubmit

//page_employees_record_Delete1_OnClick @17-6AF49C5D
function page_employees_record_Delete1_OnClick()
{
    disableValidation = true;
}
//End page_employees_record_Delete1_OnClick

//page_employees_record_Cancel_OnClick @18-EC776A86
function page_employees_record_Cancel_OnClick()
{
    disableValidation = true;
}
//End page_employees_record_Cancel_OnClick

//bind_events @1-43C6B8E9
function bind_events() {
    if (document.forms["employees_record"]) check_and_bind('document.forms["employees_record"]','onsubmit',page_employees_record_OnSubmit);
    if (document.forms["employees_record"]) check_and_bind('document.forms["employees_record"].LeftButton','onclick',page_employees_record_LeftButton_OnClick);
    if (document.forms["employees_record"]) check_and_bind('document.forms["employees_record"].RightButton','onclick',page_employees_record_RightButton_OnClick);
    if (document.forms["employees_record"]) check_and_bind('document.forms["employees_record"].Delete1','onclick',page_employees_record_Delete1_OnClick);
    if (document.forms["employees_record"]) check_and_bind('document.forms["employees_record"].Cancel','onclick',page_employees_record_Cancel_OnClick);
    forms_onload();
}
//End bind_events

window.onload = bind_events; //Assign bind_events @1-19F7B649

//End CCS script
</script>
<link rel="stylesheet" type="text/css" href="../Styles/EXPack/Style_doctype.css">
<!--[if IE 6]><link rel="stylesheet" type="text/css" href="../Styles/EXPack/Style_ie6.css"><![endif]-->
</head>
<body>
{Header} 
<h2>Updating Many-to-Many Relations via Two Listboxes</h2>
<p><a href="{Link1_Src}">View more information about this example</a></p>
<table>
  <tr>
    <td valign="top">
      <!-- BEGIN Grid employees -->
      <table cellspacing="0" cellpadding="0" border="0">
        <tr>
          <td valign="top">
            <table class="Header" cellspacing="0" cellpadding="0" border="0">
              <tr>
                <td class="HeaderLeft"><img src="../Styles/EXPack/Images/Spacer.gif" border="0" alt=""></td> 
                <td class="th">
                  <strong>Employees</strong>
 </td> 
                <td class="HeaderRight"><img src="../Styles/EXPack/Images/Spacer.gif" border="0" alt=""></td> 
              </tr>
 
            </table>
 
            <table class="Grid" cellspacing="0" cellpadding="0">
              <tr class="Caption">
                <th>
                <!-- BEGIN Sorter Sorter_department_name --><a href="{Sort_URL}">ID</a><!-- END Sorter Sorter_department_name --></th>
 
                <th>
                <!-- BEGIN Sorter Sorter_emp_name --><a href="{Sort_URL}">Employees</a><!-- END Sorter Sorter_emp_name --></th>
 
              </tr>
 
              <!-- BEGIN Row -->
              <tr class="Row">
                <td>{emp_id}</td> 
                <td><a href="{emp_name_Src}">{emp_name}</a></td> 
              </tr>
 <!-- END Row -->
              <!-- BEGIN NoRecords -->
              <tr class="NoRecords">
                <td colspan="2">No records</td> 
              </tr>
 <!-- END NoRecords -->
              <tr class="Footer">
                <td nowrap colspan="2"><a href="{Link1_Src}">Add New</a>&nbsp; 
                  <!-- BEGIN Navigator Navigator -->
                  <!-- BEGIN First_On --><a href="{First_URL}"><img src="../Styles/EXPack/Images/First.gif" border="0" alt="{First_URL}"></a> <!-- END First_On -->
                  <!-- BEGIN First_Off --><img src="../Styles/EXPack/Images/FirstOff.gif" border="0" alt="First Off"><!-- END First_Off -->
                  <!-- BEGIN Prev_On --><a href="{Prev_URL}"><img src="../Styles/EXPack/Images/Prev.gif" border="0" alt="{Prev_URL}"></a> <!-- END Prev_On -->
                  <!-- BEGIN Prev_Off --><img src="../Styles/EXPack/Images/PrevOff.gif" border="0" alt="Prev Off"><!-- END Prev_Off -->&nbsp; 
                  <!-- BEGIN Pages -->
                  <!-- BEGIN Page_On --><a href="{Page_URL}">{Page_Number}</a>&nbsp;<!-- END Page_On -->
                  <!-- BEGIN Page_Off -->{Page_Number}&nbsp;<!-- END Page_Off --><!-- END Pages -->of&nbsp;{Total_Pages}&nbsp; 
                  <!-- BEGIN Next_On --><a href="{Next_URL}"><img src="../Styles/EXPack/Images/Next.gif" border="0" alt="{Next_URL}"></a> <!-- END Next_On -->
                  <!-- BEGIN Next_Off --><img src="../Styles/EXPack/Images/NextOff.gif" border="0" alt="Next Off"><!-- END Next_Off -->
                  <!-- BEGIN Last_On --><a href="{Last_URL}"><img src="../Styles/EXPack/Images/Last.gif" border="0" alt="{Last_URL}"></a> <!-- END Last_On -->
                  <!-- BEGIN Last_Off --><img src="../Styles/EXPack/Images/LastOff.gif" border="0" alt="Last Off"><!-- END Last_Off --><!-- END Navigator Navigator -->&nbsp; </td> 
              </tr>
 
            </table>
 </td> 
        </tr>
 
      </table>
 <!-- END Grid employees --></td> 
    <td valign="top">
      <!-- BEGIN Record employees_record -->
      <form name="{HTMLFormName}" action="{Action}" method="post" id="employees_record">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td valign="top">
              <table class="Header" cellspacing="0" cellpadding="0" border="0">
                <tr>
                  <td class="HeaderLeft"><img src="../Styles/EXPack/Images/Spacer.gif" border="0" alt=""></td> 
                  <td class="th">
                    <strong>Add/Edit Employees</strong>
 </td> 
                  <td class="HeaderRight"><img src="../Styles/EXPack/Images/Spacer.gif" border="0" alt=""></td> 
                </tr>
 
              </table>
 
              <table class="Record" cellspacing="0" cellpadding="0">
                <!-- BEGIN Error -->
                <tr class="Error">
                  <td colspan="2">{Error}</td> 
                </tr>
 <!-- END Error -->
                <tr class="Controls">
                  <td class="th"><label for="employees_recordemp_name">Name</label></td> 
                  <td><input maxlength="50" size="50" value="{emp_name}" name="{emp_name_Name}" id="employees_recordemp_name"></td> 
                </tr>
 
                <tr class="Controls">
                  <td colspan="2">
                    <table width="100%">
                      <tr class="Caption">
                        <td class="th"><label for="available">Available Projects</label></td> 
                        <td>&nbsp;</td> 
                        <td class="th"><label for="linked">Assigned Projects</label></td> 
                      </tr>
 
                      <tr>
                        <td align="center">
                          <select id="available" multiple size="6" name="{AvailableListBox_Name}">
                            {AvailableListBox_Options} 
                          </select>
 </td> 
                        <td valign="middle" align="center"><br>
                          <label for="employees_recordRightButton" style="display: none;">Add</label> 
                          <!-- BEGIN Button RightButton --><input type="button" value="&gt;&gt;" name="{Button_Name}" id="employees_recordRightButton"><!-- END Button RightButton --><br>
                          <br>
                          <label for="employees_recordLeftButton" style="display: none;">Delete</label> 
                          <!-- BEGIN Button LeftButton --><input type="button" value="&lt;&lt;" name="{Button_Name}" id="employees_recordLeftButton"><!-- END Button LeftButton --></td> 
                        <td align="center">
                          <select id="linked" multiple size="6" name="{LinkedListBox_Name}">
                            {LinkedListBox_Options} 
                          </select>
 </td> 
                      </tr>
 
                    </table>
 <input type="hidden" value="{LinkedID}" name="{LinkedID_Name}"></td> 
                </tr>
 
                <tr class="Bottom">
                  <td align="right" colspan="2">
                    <!-- BEGIN Button Insert1 --><input type="image" src="../Styles/EXPack/Images/en/ButtonInsert.gif" value="Add" name="{Button_Name}" alt="{res:CCS_Insert}"><!-- END Button Insert1 -->
                    <!-- BEGIN Button Update1 --><input type="image" src="../Styles/EXPack/Images/en/ButtonUpdate.gif" value="Submit" name="{Button_Name}" alt="{res:CCS_Update}"><!-- END Button Update1 -->
                    <!-- BEGIN Button Delete1 --><input type="image" src="../Styles/EXPack/Images/en/ButtonDelete.gif" value="Delete" name="{Button_Name}" alt="{res:CCS_Delete}"><!-- END Button Delete1 -->
                    <!-- BEGIN Button Cancel --><input type="image" src="../Styles/EXPack/Images/en/ButtonCancel.gif" value="Cancel" name="{Button_Name}" alt="{res:CCS_Cancel}"><!-- END Button Cancel --></td> 
                </tr>
 
              </table>
 </td> 
          </tr>
 
        </table>
 
      </form>
 <!-- END Record employees_record --></td> 
  </tr>
</table>
{Footer}
</body>
</html>
